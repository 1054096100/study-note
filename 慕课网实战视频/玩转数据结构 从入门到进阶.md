# 玩转数据结构 从入门到进阶

## 第12章 AVL

### 12-1 平衡树和AVL

#### 定义

对于任意一个节点，左子树和右子树的高度差不能为超过1

![](http://oklbfi1yj.bkt.clouddn.com/%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6/1.png)

当我们往这个平衡二叉树添加一个节点（节点的值是2）的时候，这棵二叉树变为下图：

![](http://oklbfi1yj.bkt.clouddn.com/%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6/2.png)

此时，这棵树已经不是平衡二叉树了。

我们给每个节点标注一下它的高度，如下图所示：

![](http://oklbfi1yj.bkt.clouddn.com/%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6/3.png)

#### 平衡因子

每个节点的平衡因子指的是该节点的**左子树高度 - 右子树高度**，如下图所示；

![](http://oklbfi1yj.bkt.clouddn.com/%E7%8E%A9%E8%BD%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6/4.png)

我们通过平衡因子就可以判断一棵树是否是平衡二叉树。（只要二叉树中某个节点它的平衡因子大于等于2或者小于等于-2（即绝对值大于等于2），那么这棵树就不是平衡二叉树）。从图中我们可以看出，值为8、值为12的这两个节点它们的平衡因子是2，所以这两个节点破坏了平衡二叉树的性质。

一旦我们计算出了每个节点的平衡因子，那么我们就可以判断当前的二叉树是否是一棵平衡二叉树。

### 12-2 计算节点的高度和平衡因子

每个节点默认高度初始化为1，也就是说对于每一个新的节点，默认它为叶子节点（即添加的位置一定是一个叶子节点的位置），因此高度为1。












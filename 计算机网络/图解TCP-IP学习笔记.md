# 图解TCP-IP学习笔记

1、![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/1.PNG)

2、

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/2.PNG)

3、TCP/TP是**通信协议的统称**

4、在计算机网络与信息通信领域里，人们经常提及“协议”一词。互联网中常用的具有代表性的协议有IP、TCP、HTTP等。而LAN(局域网)中常用的协议有IPX/SPX等。“计算机网络体系结构”将这些网络协议进行了系统的归纳。TCP/IP就是IP、TCP、HTTP等协议的集合。

5、![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/3.PNG)

6、分组交换协议

​	分组交换是指将大数据分割为一个个叫做包的较小单位进行传输的方法。

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/4.PNG)

7、协议的分层

​	OSI参考模型，这一模型将通信协议中必要的功能分成了7层，在这一模型中，每个分层都接收由它下一层所提供的特定服务，并且负责为自己的上一层提供特定的服务。上下层之间进行交互时所遵循的约定叫做“接口”。同一层之间的交互所遵循的约定叫做“协议”

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/5.PNG)

8、**分层可以将每个分层独立使用，即时系统中某些分成发生变化，也不会波及整个系统**。举个生活中的例子：如果我们用汉语（语言层，汉语协议）并且用电话机（通信设备层）这个设备交流，交流的双方都可以听懂对方的讲话。但是，我们如果用英语（英语协议）交流，通信设备仍然用电话机的话会怎么么样？双方还能不能听懂？很显然是可以的。这也就是说我们如果改变了语言层，是不影响我们的交流的。同样的，如果我们使用汉语（语言协议）交流，通信设备改用为无线电，双方仍然可以听懂别人说的话。这就是说改变通信设备层也是不影响我们交流的。

9、

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/6.PNG)

每个层上的协议规定了该分层中数据首部的格式以及首部与处理数据的顺序

10、通信传输实际上是通过物理的传输介质实现的。数据链路层的作用就是在这些通过传输介质互联的设备之间进行数据处理。

​	物理层中，将数据的0、1转换为电压和脉冲光传输给物理的传输介质，而相互直连的设备之间使用地址实现传输。这种地址称为MAC地址，也可称为物理地址或硬件地址。采用MAC地址，目的是为了识别连接到同一个传输介质上的设备。

11、传输方式的分类

​	**面向有连接型和面向无连接型**![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/7.PNG)

**面向无连接型**则不需要建立和断开连接。发送端可于任何时候自由发送数据。接收端也永远不知道自己会在何处从哪里收到数据。因此，在面向无连接的情况下，接收端需要时常确认是否收到了数据。而且，不需要确认对端是否存在，**即使接收端不存在或无法收到数据，发送端也能将数据发送出去**

对于无连接型的，如果要**检查**对端是否收到分组数据包，或者对端是否连接到网络，则**需要在应用程序中实现**

**电路交换与分组交换**

​	TCP/IP采用了**分组交换**(蓄积交换)技术。

​	分组交换：即让连接到通信电路的计算机将所要发送的数据分成多个数据包，按照一定的顺序排列之后分别发送，这就是分组交换。有了分组交换，数据被细分后，所有的计算机就可以一齐收发数据，这样也就提高了通信线路的利用率。由于在分组的过程中，已经在每个分组的首部写入了发送端和接收端的地址，所以即使同一条线路同时为多个用户提供服务，也可以明确区分每个分组数据发往的目的地，以及它是与哪台计算机进行的通信

根据接收端数量分类：单播、广播、多播、任播

12、**在网络通信当中，每一层的协议所使用的地址都不尽相同**。例如，TCP/IP通信中使用MAC地址、IP地址、端口号等信息作为地址标识。甚至在应用层中，可以将电子邮件地址作为网络通信的地址

​	地址的**唯一性**

​	地址的**层次性**：假设想找“A-b-1”所在的地址，就可以按照“A”->“A-b”->“A-b-1”的顺序寻找。**IP地址与之类似**

​				    	MAC地址没有层次性

​	MAC地址由设备的制造厂商针对每块网卡进行分别指定，具有唯一性。因为不具有层次性，所以对于寻找地址没有起到任何作用，所以，虽然**MAC地址是真正负责最终通信的地址**，但是在实际寻址过程中，IP地址却必不可少。

​	IP地址由**网络号和主机号**两部分组成

​	实际的地址转发表与路由控制表中能获取的信息并不是具体的目标地址，而是该数据应该被发送出去的网卡信息

13、搭建网络的主要设备及其作用

​	![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/8.PNG)

任何一台计算机连接网络时，必须要使用网卡(全称为网络接口卡)。也会叫做网络适配器、LAN卡。

网桥是根据物理地址(MAC地址)进行处理

路由器(在OSI模型的第3层)是连接网络与网络的设备，可以将分组报文发送给另一个目标路由器地址，**基本上可以连接任意两个数据链路**。路由器是根据IP地址进行处理的。由此，TCP/IP中网络层的地址就成为了IP地址

**网关负责协议的转换与数据的转发**，在同一种类型的协议之间转发数据叫做应用网关。在两个不能直接通信的协议之间进行翻译，最终实现两者之间的通信

14、利用虚拟化技术，根据使用者的情况动态调整必要资源的机制被人们称作“云”。有了“云”，网络使用者就可以实现无论何时何地都可以只获取或只提供需要信息的机制。在网络云中，也需要一个像交响乐指挥的协调者，它可以根据使用者的需求，自动地调整存储、cpu、内存等资源

15、

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/9.PNG)

16、**分组技术可以****使多个用户同一时间共享一条通信线路进行通信**，从而提高了线路的使用效率，也降低了搭建线路的成本

17、TCP/IP网际协议族

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/10.PNG)

18、OSI参考模型与TCP/IP的关系

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/11.PNG)

​	IP协议基于IP地址转发分包数据

​	IP是跨越网络传送数据包，使整个互联网都能收到数据的协议。IP使数据能够发送到地球的另一端，这期间它使用IP地址作为主机的标识

​	虽然IP也是分组交换的一种协议，但是它不具有重发机制。即使分组数据包未能到达对端主机也不会重发。因此，**属于非可靠性传输协议**

​	TCP/IP分层中的互联网层与传输层的功能通常由操作系统提供。尤其是路由器，他必须得实现通过互联网层转发分组数据包的功能

ARP从分组数据包的IP地址中解析出物理地址(MAC地址)的一种协议

19、驱动程序是在操作系统与硬件之间起桥梁作用的软件。我们常常需要在操作系统的基础上安装一些驱动软件以便使用一些附加的硬件

20、传输层最主要的功能就是能过让应用程序之间实现通信。计算机内部，通常同一时间运行着多个程序。为此，必须分清楚是哪些程序与哪些程序在进行通信。识别这些应用程序的是**端口号**

21、浏览器与服务端之间通信所用的协议是HTTP，所传输的主要格式是HTML。WWW中的HTTP属于OSI应用层的协议，而HTML属于表示层的协议

22、文件传输是指将保存在其他计算机硬盘上的文件转移到本地的硬盘上，或将本地硬盘的文件传送到其他机器硬盘上的意思。该过程使用的协议叫做FTP。在FTP中进行文件传输时会建立两个TCP连接，分别是发出传输请求时所要用到的控制连接与实际传输数据时所要用到的数据连接

23、远程登录是指登录到远程的计算机上，使那台计算机上的程序得以运行的一种功能。**TCP/IP网络中远程登录常用TELNET和SSH两种协议**

24、TCP首部中包括源端口号和目标端口号(用以识别发送主机跟接收主机上的应用)、序号以及校验

25、

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/12.PNG)

26、对于有路由器的情况下，接收端地址往往不是自己的地址，此时，需要借助**路由控制表**，在调查应该送达的主机或路由器以后再转发数据

27、MAC地址长48比特，在使用网卡(NIC)的情况下，MAC地址一般会被烧入到ROM中。因此，**任何一个网卡的MAC地址都是唯一的，在全世界都不会重复**

28、主机与节点

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/13.PNG)

29、数据链路层提供直连两个设备之间的通信功能。与此相比，作为网络层的IP则负责在没有直连的两个网络之间进行通信传输。用旅行的例子来说就是：行程表的作用相当于网络层，机票、车票相当于数据链路层

30、IP地址用于在“连接到网络中的所有主机中识别出进行通信的目标地址”。因此，在TCP/IP通信中所有主机或路由器必须设定自己的IP地址

31、IP采用面向无连接的原因

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/14.PNG)

为了提高可靠性，上一层的TCP采用面向有连接型

32、IP地址的定义

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/15.PNG)

实际上，因为网络标识和主机标识的存在，是达不到那么多台的

一台主机至少可以设置一个以上的IP地址，一台路由器可以设置两个以上的IP地址，一块网卡也可以设置两个以上的IP地址

33、关于分配IP主机地址的注意事项

​	**在分配IP地址时关于主机标识**有一点需要注意。即要用比特位表示主机地址时，**不可以全部为0或全部为1**。因为全部为0在表示对应的网络地址或IP地址不可获知的情况下才能使用。而全部为1的主机地址通常作为广播地址

34、单播、广播、多播通信

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/16.PNG)

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/17.PNG)

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/18.PNG)

35、网络标识相同的计算机必须同属于同一个链路

36、**子网与子网掩码(不太懂)**

这种方式实际上就是将原来A类、B类、C类等分类中的主机地址部分用作子网地址，可以将原网络分为多个物理网络的一种机制

37、**CIDR不太懂**

38、IP旨在让最终目标主机收到数据包，但是在这一过程中仅仅有IP是无法实现通信的。必须还有能够解析主机名称和MAC地址的功能，以及数据包在发送过程中异常情况处理的功能。

39、进行DNS查询的主机和软件叫做DNS解析器。用户所使用的工作站或个人电脑都属于解析器。一个解析器至少要注册一个以上域名服务器的IP地址。通常，它至少包括内部的域名服务器的IP地址

40、DNS查询

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/19.PNG)

41、DNS如同互联网中的分布式数据库，是一种通过主机名检索IP地址的系统

42、TCP与UDP：TCP提供可靠的通信传输，而UDP则常被用于让**广播和细节控制**交给应用的通信传输

43、在传输层必须指出这个具体的程序，为了实现这以功能，使用端口号这样一种识别码。根据端口号就可以识别在传输层上一层的应用层中所要进行处理的具体程序。（**一个程序可以使用多个端口**）

44、 TCP为提供可靠性传输，实行“**顺序控制**”或“**重发控制**”机制。UDP是不具有可靠性的数据报协议。但是，这并不能说明TCP优于UDP

​	TCP用于在传输层有必要实现可靠传输的情况。由于它是面向有连接并具备顺序控制、重发控制等机制的，所以它可以应用提供可靠传输。UDP主要用于那些对高速传输和实时性有较高要求的通信或广播通信

45、数据链路和IP中的地址，分别用来指的是MAC地址和IP地址。前者用来识别同一链路中不同的计算机，后者用来识别TCP/IP网络中互连的主机和路由器

​	在传输层中也有这种类似于地址的概念，那就是**端口号**。端口号用来**识别同一台计算机中进行通信的不同应用程序**。因此，它也被称为**程序地址**

46、TCP/IP或UDP/IP通信中通常采用5个信息来识别一个通信。它们是“源IP地址”、“目标IP地址”、“协议号”、“源端口号”、“目标端口号”。只要其中某一项不同，则被认为是其他通信

47、端口号由其使用的传输层协议决定。因此，不同的传输协议(例如TCP和UDP)可以使用相同的端口号

48、UDP不提供复杂的控制机制，利用IP提供面向无连接的通信服务。并且它是将应用程序发来的数据在收到的那一刻，**立即按照原样发送**到网络上的一种机制。

​	UDP类似于用户说什么听什么的机制(可以认为UDP是按照程序员的编程思路在传送数据报)，但是需要用户充分考虑好上层协议类型并制作相应的应用程序

​	由于UDP面向无连接，它可以随时发送数据

​	由于TCP拥有各式各样的控制机制，所以它在发送数据时未必按照程序员的编程思路进行

49、套接字(socket)

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/20.PNG)



50、根据端口号识别应用

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/21.PNG)



51、通过序列号与确认应答提高可靠性

​	**正常的数据传输：**

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/22.PNG)



**数据包丢失的情况：**

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/23.PNG)



**确认应答丢失的情况：**

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/24.PNG)

52、序列号(或确认应答号)也指字节与字节之间的分隔

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/25.PNG)

53、数据不会无限、反复地重发。达到一定重发次数之后，如果仍没有任何确认应答返回，就会判断为网络或对端主机发生了异常，强制关闭连接。并且通知应用通信异常强行终止

54、可以使用TCP首部用于控制的字段来管理TCP连接。一个连接的建立与断开，正常过程至少需要来回发送7个包才能完成(建立一个TCP连接需要发送3个包。这个过程也称作“三次握手”)

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/26.PNG)

55、TCP以段为单位发送数据

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/28.PNG)

56、为每个数据包进行确认应答的缺点是，包的往返时间越长，网络的吞吐量会越差

57、在开发应用的时候，有必要考虑一下是全权交给TCP去处理好，还是由应用自己进行更细微的控制好。如果需要应用自己处理一些更为细节的控制，使用UDP协议是不错的选择。如果转发的数据量较多、对可靠性的要求比较高时，可以选择使用TCP

58、应用层协议

​	利用网络的应用程序有很多，包括Web浏览器、电子邮件、远程登录、文件传输、网络管理等。能够让这些应用进行特定通信处理的正是应用协议

​	**TCP和IP等下层协议是不依赖于上层应用类型、适用性非常广的协议**。而应用协议则是为了实现某种应用而设计和创造的协议。例如，**远程登录**等应用经常使用的**TELNET协议**

59、远程登录

​	主要使用TELNET和SSH两种协议

TELNET中输入命令、运行、展示结果的过程：

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/29.PNG)



**TELNET客户端：**

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/30.PNG)



**SSH是加密的远程登录系统**。TELNET中登录时无需输入密码就可以发送

SSH还包括很多非常方便的功能：

​	可以使用更强的认证机制、可以转发文件、可以使用端口转发功能

​	**端口转发是指将特定端口号所收到的消息转发到特定的IP地址和端口号码的一种机制**

60、文件传输

FTP是在两个**相连的**计算机之间进行文件传输时使用的协议，**FTP需要登录到对方的计算机后才能进行相应的操作**

**FTP使用两条TCP连接：一条用来控制，另一条用来数据(文件)的传输。控制用的连接，在用户要求断开之前会一直保持连接状态(不过，绝大多数FTP服务器都会对长时间没有任何新命令输入的用户的连接强制断开)。而数据连接只有在进行数据传输等操作的时候才会建立连接，数据传送完毕之后，传输数据的这条连接也会被断开**

61、WWW

万维网是将互联网中的信息以超文本形式展现的系统，也叫做Web

62、相比于URL狭义的概念，URI则是一个广义的概念。因此，URI可以用于除了WWW之外的其他应用协议中

63、HTTP

​	当用户在浏览器的地址栏里输入所要访问Web页的URI以后，HTTP的处理即会开始。HTTP中默认使用80端口。它的工作机制，首先是客户端向服务器的80端口建立一个TCP连接，然后在这个TCP连接上进行请求和应答以及数据报文的发送

64、CGI是Web服务器调用外部程序时所使用的一种服务端应用的规范。引入CGI以后客户端请求会触发Web服务器端运行另一个程序，客户端所输入的数据也会传给这个外部程序。该程序运行结束后会将生成的HTML和其他数据再返回给客户端

利用CGI可以针对用户的操作返回给客户端有各种各样变化(动态)的信息

65、从Web服务器检测Cookie可以确认是否为同一对端的通信

66、VPN(虚拟专用网)

​	互联网中采用加密和认证技术可以达到“即使读取到数据也无法读懂”、“检查是否被篡改”等功效。VPN正是一种利用这两种技术打造的网络

![](http://oklbfi1yj.bkt.clouddn.com/%E5%9B%BE%E8%A7%A3TCP-IP/31.PNG)


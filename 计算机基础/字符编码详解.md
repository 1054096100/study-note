# 字符编码详解

把所有的空格、标点符号、数字、大小写字母分别用连续的字节状态表示，一直编到了第127号，这样计算机就可以用不同字节来存储**英语的**文字了。大家看到这样，都感觉很好，于是大家都把这个方案叫做 ANSI 的”Ascii”编码。当时世界上所有的计算机都用同样的ASCII方案来**保存英文文字**

后来，就像建造巴比伦塔一样，世界各地的都开始使用计算机，但是很多国家用的不是英文，他们的字母里有许多是ASCII里没有的，为了可以在计算机保存他 们的文字，他们决定采用127号之后的空位来表示这些新的字母、符号。一直把序号编到了最后一 个状态255。**从128到255这一页的字符集被称”扩展字符集”**

等中国人们得到计算机时，已经没有可以利用的字节状态来表示汉字。但是这难不倒智慧的中国人民，我们不客气地把那些127号之后的奇异符号们直接取消掉。**规定**：一个小于127的字符的意义与原来相同，但两个大于127的字符连在一起时，就表示一个汉字，前面的一个字节（他称之为高字节）从0xA1用到 0xF7，后面一个字节（低字节）从0xA1到0xFE，这样我们就可以组合出大约7000多个简体汉字了。在这些编码里，我们还把数学符号、罗马希腊的 字母、日文的假名们都编进去了，连**在 ASCII 里本来就有的数字、标点、字母都统统重新编了两个字节长的编码，这就是常说的”全角”字符，而原来在127号以下的那些就叫”半角”字符了**。把这种汉字方案叫做 “GB2312″。GB2312 是对 ASCII 的中文扩展

**后来还是不够用，**于是干脆不再要求低字节一定是127号之后的内码，**只要第一个字节是大于127就固定表示这是一个汉字的开始**，不管后面跟的是不是扩展字符集里的内容。**结果扩展之后的编码方案被称为 GBK 标准**，GBK 包括了 GB2312 的所有内容，同时又增加了近20000个新的汉字（包括繁体字）和符号

#### 当时各个国家都像中国这样搞出一套自己的编码标准，结果互相之间谁也不懂谁的编码，谁也不支持别人的编码

正在这时， ISO（国际标谁化组织）国际组织决定着手解决这个问题。他们采用的方法很简单：废了所有的地区性编码方案，重新搞一个包括了地球上所有文化、所有字母 和符号的编码！他们打算叫它”Universal Multiple-Octet Coded Character Set”，**俗称 “UNICODE”** 。**规定必须用两个字节，也就是16位来统一表示所有的字符**，对于ascii里的那些“半角”字符，UNICODE 包持其原编码不变，只是将其长度由原来的8位扩展为16位，而其他文化和语言的字符则全部重新统一编码。由于”半角”英文符号只需要用到低8位，所以其高 8位永远是0

**从 UNICODE 开始，无论是半角的英文字母，还是全角的汉字，它们都是统一的”一个字符”**！同时，也都是**统一的”两个字节”**，请注意”字符”和”字节”两个术语的不 同，“字节”是一个8位的物理存贮单元，而“字符”则是一个文化相关的符号。**在UNICODE 中，一个字符就是两个字节**。一个汉字算两个英文字符的时代已经快过去了

UNICODE 来到时，一起到来的还有计算机网络的兴起，UNICODE 如何在网络上传输也是一个必须考虑的问题，于是**面向传输的**众多 UTF（UCS Transfer Format）标准出现了，顾名思义，**UTF8就是每次8个位传输数据，而UTF16就是每次16个位**，只不过为了传输时的可靠性，从UNICODE到 UTF时并不是直接的对应，而是要过一些算法和规则来转换

#### 在数据库里，有n前缀的字串类型就是UNICODE类型，这种类型中，固定用两个字节来表示一个字符，无论这个字符是汉字还是英文字母，或是别的什么

#### 如果你要测试”abc汉字”这个串的长度，在没有n前缀的数据类型里，这个字串是7个字符的长度，因为一个汉字相当于两个字符。而在有n前缀的数据类型里，同样的测试串长度的函数将会告诉你是5个字符，因为一个汉字就是一个字符
# WeChat

主要功能；聊天

使用的技术主要有：PHP7.1、Swoole、JS、Vue.js2、MySQL。

用nginx作为前端的代理服务器，用它把请求发给处理登录的进程。

## 登录

使用AJAX技术把用户注册的名字插入onlines表。

## 在线用户的显示

使用Javascript的定时器对数据库进行轮询，时间间隔是2秒。

在线列表的更新是通过Vue.js的动态数据绑定实现数据更新，视图立马更新。

判断用户是否登录是判断客户端是否还和服务器保持连接。如果用户登录了，此时用户的状态是1；如果不再连接，则认为用户已经下线了。

下线的用户并不会从数据库里面删除，而是把它的状态变为0，目的是为了保证数据库中`messages`表和`onlines`表的完整性，且保存聊天记录。如果同一个客户端再次连接服务器，我们认为它是另一个用户。

## 聊天功能

### Swoole

用swoole作为应用的服务器，处理从客户端发来的聊天数据。

### WebSocket

使用WebSocket来保持客户端和服务器的持久连接，实现即时通信。

### 显示消息发送成功

利用Vue.js的四个过渡状态实现。

## 直播

用swoole作为应用的服务器，处理从客户端发来的视频数据。然后推送给每一个客户端。

前端页面是用一张张img（图片）来更新我们看到的视频。（技术缺陷）



swoole.so目录：/usr/local/php/lib/php/extensions/no-debug-non-zts-20160303/swoole.so







